 Советы при автоматизации:
Если ты ищешь зубец S в коде:

Найди индекс пика R.

Ищи первый минимум после R в пределах 20–80 мс.

Убедись, что амплитуда опускается ниже изолинии.

Используй фильтрацию шума (например, сглаживание) и нормализацию.


Если первый минимум после R находится в пределах 20–80 мс, но при этом его амплитуда выше изолинии (то есть он положительный или незначительно отрицательный), то это, скорее всего, не зубец S, а:

либо просто конец R (если R широкий и несимметричный),

либо часть перехода к сегменту ST,

либо шум или морфология без выраженного S.


Что делать в таком случае?
✅ Алгоритм принятия решения:
Проверь, есть ли минимум НИЖЕ изолинии:

Если нет, то S может отсутствовать (такое бывает — например, в отведении V5 у здорового человека).

Если есть позже, но всё ещё в пределах физиологического окна (до ~100 мс после R), то его и считать S.

Не принимать положительный минимум как S:

Зубец S по определению — отрицательный, то есть должен быть ниже изолинии.

Положительный минимум — это просто локальная яма между двумя положительными участками и не считается S.

Изолиния — ключ:

Амплитуда S должна быть отрицательной относительно изолинии.

Если ты не определяешь изолинию точно, можно взять среднее значение PQ-интервала или прилежащего участка до P.

